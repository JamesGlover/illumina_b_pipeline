  <table class="plate-view">
    <thead>
      <tr>
        <th class="first-col">&nbsp;</th>
        <% (1..12).each do |column_number| %>
          <th><%= column_number %></th>
        <% end %>
      </tr>
    </thead>

    <tbody>


      <%= form.fields_for(:transfers, plate_presenter.transfers ) do |fields| %>
      <% plate_presenter.source_wells_by_row.each do |row_label, row_wells| %>
        <tr>
          <th class="first-col"><%= row_label %></th>
          <% (0...12).map { |index| [ row_wells[index], index ] }.each do |well, index| %>
            <td class="col-all <%= "col-#{index+1}" %>">
              <% location = well.try(:location) || "Z1" %>
              <div id="<%= "source_well_#{location}" %>" class="well source_well">
                <% unless well.try(:aliquots).blank? -%>
                  <div id="<%= "source_aliquot_#{well.location}" %>" class="aliquot source_aliquot <%= custom_pooling_colour( plate_presenter.transfers[well.location]) %>" rel="<%= "#details_#{well.location}" %>"><%= plate_presenter.transfers[well.location] %></div>
                    <%= fields.hidden_field well.location %>
                <% end %>
              </div>
            </td>
          <% end %>
        </tr>
      <% end %>
      <% end %>
    </tbody>
  </table>


